---
title: "IMRaD report for Karl"
author: "Alexandra Stephenson"
date: today
format: 
  html:
    self-contained: true
    df-print: tibble
editor_options:
  chunk_output_type: console
execute:
  warning: false
  message: false
  echo: false
bibliography: references.bib
---

# A predictive model of gene expression
-   Y = gene expression
-   X = concentration (numerical), treatment (factor, 2 levels), cell line (factor, 2 levels)

```{r}
pacman::p_load(tidyverse, readr)
data <- read_csv("data/2023-03-01_gene-data.csv")
data_long <- data %>%
  mutate(CL = `cell line`,
         treat = treatment) %>%
  unite(`cell line`, `treat`, sep = "; ", col = "grouping") %>%
  pivot_longer(cols = 4:14, names_to = "concentration", values_to = "GE") %>%
  filter(GE >= 0) %>%
  mutate(concentration = as.integer(concentration),
         sheet_names = as.factor(sheet_names),
         CL = as.factor(CL),
         treatment = as.factor(treatment),
         grouping = as.factor(grouping))
```

```{r}
pacman::p_load(lme4)
```

```{r}
test1 <- lmer(GE ~ concentration + (1|sheet_names), data = data_long, na.action = na.omit)
summary(test1)
test2 <- lmer(GE ~ concentration + treatment*CL + (1|sheet_names), data = data_long, na.action = na.omit)
summary(test2)
test3 <- lmer(GE ~ concentration*treatment*CL + (1|sheet_names), data = data_long, na.action = na.omit)
summary(test3)
```

# Introduction

# Method

-   R language [@r-2022]
-   tidyverse [@tidyverse]
-   rstatix [@rstatix]
-   ggpubr [@ggpubr]
-   patchwork [@patchwork]
-   showtext [@showtext]
-   ggrepel [@ggrepel]
-   lme4 [@lme4]

# Appendix: Code
```{r ref.label=knitr::all_labels()}
#| eval: false
#| echo: true
```

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
